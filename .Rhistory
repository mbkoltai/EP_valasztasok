ggsave(width=40,height=28,units="cm")
}
# PLOT FIDESZ vs ellenzek szavazatszam-kulonbseg valtozas
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szavszam_kulonbseg_2019) | is.na(szavszam_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szavazat)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szavszam_kulonbseg_2019/1e3,xend=szavszam_kulonbseg_2024/1e3,
y=sorrend,yend=sorrend,alpha=valtozas_szavazat),
arrow=arrow(length=unit(0.15,"cm")) ) + #
geom_point(data=l_plot_swing$dummy_df_xlims,aes(x=szavszam_kulonbseg_2019,y=sorrend), # x axis limits
color=NA,show.legend=F) +
geom_text(data=l_plot_swing$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szavszam_kulonbseg_2024>szavszam_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("FIDESZ vs. ellenzék szavazatszám-különbség (ezer) 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
theme_bw() + val_theme
"PLOTS/FIDESZKDNP_2019_2024_valtozas_szavszamkulonb_y_meretsorrend_segment_xaxis_2rows.png" %>%
ggsave(width=40,height=28,units="cm")
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szavszam_kulonbseg_2019) | is.na(szavszam_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szavazat)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szavszam_kulonbseg_2019/1e3,xend=szavszam_kulonbseg_2024/1e3,
y=sorrend,yend=sorrend,alpha=valtozas_szavazat),
arrow=arrow(length=unit(0.15,"cm")) ) + #
geom_point(data=l_plot_swing$dummy_df_xlims,aes(x=szavszam_kulonbseg_2019,y=sorrend), # x axis limits
color=NA,show.legend=F) +
geom_text(data=l_plot_swing$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szavszam_kulonbseg_2024>szavszam_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("szavazatszám-különbség (ezer) 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék szavazatszám-különbség (ezer) 2019→2024") +
theme_bw() + val_theme
"PLOTS/FIDESZKDNP_2019_2024_valtozas_szavszamkulonb_y_meretsorrend_segment_xaxis_2rows.png" %>%
ggsave(width=40,height=28,units="cm")
paste0("PLOTS/FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png")
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
# geom_text(data=l_plot_swing$szazalek$df_text,
#           aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
#               hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)),
#           size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
l_plot_swing$szazalek$df_text = l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS))
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
l_plot_swing$szazalek$df_text
View(l_plot_swing$szazalek$df_text)
l_plot_swing$szazalek$df_text = l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(xadj,sorrend,TELEPÜLÉS,szazalek_kulonbseg_2019,szazalek_kulonbseg_2024)
l_plot_swing$szazalek$df_text
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
l_plot_swing$szazalek$df_text = l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(xadj,sorrend,TELEPÜLÉS,valtozas_szazalek,
szazalek_kulonbseg_2019,szazalek_kulonbseg_2024)
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
# geom_text(data=l_plot_swing$szazalek$df_text,
#           aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
#               hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)),
#           size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
l_plot_swing$szazalek$df_text
l_plot_swing$szazalek$df_text <- l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(sorrend,TELEPÜLÉS,valtozas_szazalek,
szazalek_kulonbseg_2019,szazalek_kulonbseg_2024,xadj)
l_plot_swing$szazalek$df_text
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS),
# hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
l_plot_swing$szazalek$df_text
View(l_plot_swing$szazalek$df_text)
l_plot_swing$szazalek$df_text <- l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(sorrend,TELEPÜLÉS,telep_meret,valtozas_szazalek,
szazalek_kulonbseg_2019,szazalek_kulonbseg_2024,xadj)
View(l_plot_swing$szazalek$df_text)
l_plot_swing$szazalek$df_text <- l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(sorrend,TELEPÜLÉS,telep_meret,n_valpolg_nevjegyz_2024,valtozas_szazalek,
szazalek_kulonbseg_2019,szazalek_kulonbseg_2024,xadj)
View(l_plot_swing$szazalek$df_text)
# PLOT FIDESZ vs ellenzek szazalek-kulonbseg valtozas
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS),
# hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS),
hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)
size=4,show.legend=F,alpha=1) +
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019>szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
# geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
#            aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
#            color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019<szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
l_plot_swing$szazalek$dummy_df_xlims = l_plot_swing$df_2019_24_swing_telep %>%
group_by(telep_meret) %>%
summarise(sorrend=median(sorrend)) %>%
slice(rep(1:n(), each=2)) %>%
mutate(szazalek_kulonbseg_2019=NA) %>%
mutate(szazalek_kulonbseg_2019=case_when(
grepl("20000-40000",telep_meret) ~ -40,
grepl("40000-70000",telep_meret) ~ -30,
grepl("70000+|Budapest",telep_meret) ~ -50,
.default=szazalek_kulonbseg_2019))
# text labels
l_plot_swing$szazalek$df_text <- l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(sorrend,TELEPÜLÉS,telep_meret,n_valpolg_nevjegyz_2024,valtozas_szazalek,
szazalek_kulonbseg_2019,szazalek_kulonbseg_2024,xadj)
# PLOT FIDESZ vs ellenzek szazalek-kulonbseg valtozas
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019<szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
l_plot_swing$szazalek$dummy_df_xlims = l_plot_swing$df_2019_24_swing_telep %>%
group_by(telep_meret) %>%
summarise(sorrend=median(sorrend)) %>%
slice(rep(1:n(), each=2)) %>%
mutate(szazalek_kulonbseg_2019=NA) %>%
mutate(szazalek_kulonbseg_2019=case_when(
grepl("20000-40000",telep_meret) ~ -55,
grepl("40000-70000",telep_meret) ~ -45,
grepl("70000+|Budapest",telep_meret) ~ -50,
.default=szazalek_kulonbseg_2019))
# text labels
l_plot_swing$szazalek$df_text <- l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(sorrend,TELEPÜLÉS,telep_meret,n_valpolg_nevjegyz_2024,valtozas_szazalek,
szazalek_kulonbseg_2019,szazalek_kulonbseg_2024,xadj)
# PLOT FIDESZ vs ellenzek szazalek-kulonbseg valtozas
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019<szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
l_plot_swing$szazalek$dummy_df_xlims = l_plot_swing$df_2019_24_swing_telep %>%
group_by(telep_meret) %>%
summarise(sorrend=median(sorrend)) %>%
slice(rep(1:n(), each=2)) %>%
mutate(szazalek_kulonbseg_2019=NA) %>%
mutate(szazalek_kulonbseg_2019=case_when(
grepl("20000-40000",telep_meret) ~ -55,
grepl("40000-70000",telep_meret) ~ -42,
grepl("70000+",telep_meret) ~ -45,
grepl("Budapest",telep_meret) ~ -48
.default=szazalek_kulonbseg_2019))
l_plot_swing$szazalek$dummy_df_xlims = l_plot_swing$df_2019_24_swing_telep %>%
group_by(telep_meret) %>%
summarise(sorrend=median(sorrend)) %>%
slice(rep(1:n(), each=2)) %>%
mutate(szazalek_kulonbseg_2019=NA) %>%
mutate(szazalek_kulonbseg_2019=case_when(
grepl("20000-40000",telep_meret) ~ -55,
grepl("40000-70000",telep_meret) ~ -42,
grepl("70000+",telep_meret) ~ -45,
grepl("Budapest",telep_meret) ~ -48,
.default=szazalek_kulonbseg_2019))
# text labels
l_plot_swing$szazalek$df_text <- l_plot_swing$df_2019_24_swing_telep %>%
filter(grepl("Budapest",telep_meret) |
n_valpolg_nevjegyz_2024>20e3 |
(n_valpolg_nevjegyz_2024>5e3 & delta_szazalek>0) ) %>%
group_by(TELEPÜLÉS) %>%
mutate(xadj=szazalek_kulonbseg_2024,
TELEPÜLÉS=gsub("Budapest ","",TELEPÜLÉS)) %>%
select(sorrend,TELEPÜLÉS,telep_meret,n_valpolg_nevjegyz_2024,valtozas_szazalek,
szazalek_kulonbseg_2019,szazalek_kulonbseg_2024,xadj)
# PLOT FIDESZ vs ellenzek szazalek-kulonbseg valtozas
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019<szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalek-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalek-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
# PLOT FIDESZ vs ellenzek szazalek-kulonbseg valtozas
l_plot_swing$df_2019_24_swing_telep %>%
filter(!(is.na(szazalek_kulonbseg_2019) | is.na(szazalek_kulonbseg_2024))) %>%
ggplot(aes(color=valtozas_szazalek)) +
facet_wrap(~telep_meret,scales="free",nrow=2) + #
geom_segment(aes(x=szazalek_kulonbseg_2019,xend=szazalek_kulonbseg_2024,
y=sorrend,yend=sorrend,alpha=valtozas_szazalek),
arrow=arrow(length=unit(0.15,"cm")) ) + #
geom_point(data=l_plot_swing$szazalek$dummy_df_xlims,
aes(x=szazalek_kulonbseg_2019,y=sorrend), # x axis limits
color=NA,show.legend=F) +
geom_text(data=l_plot_swing$szazalek$df_text,
aes(x=xadj,y=sorrend,label=TELEPÜLÉS,
hjust=ifelse(szazalek_kulonbseg_2019<szazalek_kulonbseg_2024,-0.1,1.1)),
size=4,show.legend=F,alpha=1) +
geom_vline(xintercept = 0,linewidth=2/3,color="black") +
labs(color="",alpha="") +
scale_color_manual(values = c("darkgreen","red")) +
scale_alpha_manual(values = c(1/2,1)) +
xlab("százalék-különbség 2019→2024") +
ylab("sorrend választópolgárok száma szerint (2024) →") +
ggtitle("FIDESZ vs. ellenzék százalék-különbség 2019→2024") +
theme_bw() + val_theme
paste0("PLOTS/","FIDESZKDNP_2019_2024_valtozas_szazalekkulonb",
"_y_meretsorrend_segment_xaxis_2rows.png") %>%
ggsave(width=40,height=28,units="cm")
getwd()
