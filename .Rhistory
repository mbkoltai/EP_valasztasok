geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=min(c(0.95*n_telep_krit,n_telep_krit-2)),label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(n_telep_krit=min(c(0.95*n_telep_krit,n_telep_krit-1)))
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(n_telep_krit=min(c(0.95*n_telep_krit,n_telep_krit-1))),
aes(x=n_telep_krit,label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.95*n_telep_krit,n_telep_krit-1))),
aes(x=x_pos,label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.95*n_telep_krit,n_telep_krit-1))),
aes(x=x_pos,label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.95*n_telep_krit,n_telep_krit-1)),
n_telep_krit=unique(n_telep_krit))
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.95*n_telep_krit,n_telep_krit-1)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.95*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.92*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam <- ep_telepules_eredmenyek_2009_2014_2019_2024 %>%
filter(EV %in% c(2019,2024) & !grepl("összesen",TELEPÜLÉS) &
!grepl("MEMO|MUNKÁSPÁRT|Hazánk",LISTA)) %>% # kiszurni: kamupartok/mihazank
mutate(lista_aggreg=case_when(!grepl("FIDESZ|Hazánk",LISTA) ~ "ellenzék",
.default=LISTA)) %>%
filter(grepl("FIDESZ|ellenzék",lista_aggreg) ) %>%
mutate(szazalek=100*SZAVAZAT/n_erv_szav) %>%
select(EV,MEGYE,TELEPÜLÉS,lista_aggreg,n_valpolg_nevjegyz,
n_erv_szav,szazalek,SZAVAZAT) %>%
group_by(MEGYE,TELEPÜLÉS,EV,lista_aggreg) %>%
summarise(n_valpolg_nevjegyz=unique(n_valpolg_nevjegyz),
n_erv_szav=unique(n_erv_szav),
szazalek=sum(szazalek),
SZAVAZAT=sum(SZAVAZAT)) %>%
group_by(MEGYE,TELEPÜLÉS,EV) %>%
summarise(szavszam_kulonbseg=SZAVAZAT[grepl("FIDESZ",lista_aggreg)]-
SZAVAZAT[grepl("ellenz",lista_aggreg)],
szazalek_kulonbseg=szazalek[grepl("FIDESZ",lista_aggreg)]-
szazalek[grepl("ellenz",lista_aggreg)],
fidesz_szazalek=szazalek[grepl("FIDESZ",lista_aggreg)],
ellenzek_szazalek=szazalek[grepl("ellenz",lista_aggreg)],
n_valpolg_nevjegyz=unique(n_valpolg_nevjegyz)) %>%
mutate(telep_meret=factor(case_when(
n_valpolg_nevjegyz[EV==2024]<=l_telep_meretek$upp_lims[1] ~ l_telep_meretek$nevek[1],
n_valpolg_nevjegyz[EV==2024]>l_telep_meretek$low_lims[2] &
n_valpolg_nevjegyz[EV==2024]<=l_telep_meretek$upp_lims[2] ~ l_telep_meretek$nevek[2],
n_valpolg_nevjegyz[EV==2024]>l_telep_meretek$low_lims[3] &
n_valpolg_nevjegyz[EV==2024]<=l_telep_meretek$upp_lims[3] ~ l_telep_meretek$nevek[3],
n_valpolg_nevjegyz[EV==2024]>l_telep_meretek$low_lims[4] &
n_valpolg_nevjegyz[EV==2024]<=l_telep_meretek$upp_lims[4] &
!grepl("Budap",TELEPÜLÉS) ~ l_telep_meretek$nevek[4], #
n_valpolg_nevjegyz[EV==2024]>l_telep_meretek$low_lims[5] &
n_valpolg_nevjegyz[EV==2024]<=l_telep_meretek$upp_lims[5] &
!grepl("Budap",TELEPÜLÉS) ~ l_telep_meretek$nevek[5], #
n_valpolg_nevjegyz[EV==2024]>l_telep_meretek$low_lims[6] &
n_valpolg_nevjegyz[EV==2024]<=l_telep_meretek$upp_lims[6] &
!grepl("Budap",TELEPÜLÉS) ~ l_telep_meretek$nevek[6],
n_valpolg_nevjegyz[EV==2024]>l_telep_meretek$low_lims[7] &
!grepl("Budap",TELEPÜLÉS) ~ l_telep_meretek$nevek[7],
grepl("Budap",TELEPÜLÉS) ~ l_telep_meretek$nevek[8]),
levels=l_telep_meretek$nevek)) %>%
group_by(TELEPÜLÉS,telep_meret) %>%
summarise(
# fidesz_szaz_nott=fidesz_szazalek[EV==2024]>=fidesz_szazalek[EV==2019],
fidesz_szaz_csokk=fidesz_szazalek[EV==2024]<fidesz_szazalek[EV==2019],
# fidesz_ellenz_kulonb_nott=(fidesz_szazalek[EV==2019]-ellenzek_szazalek[EV==2019]) <
#   (fidesz_szazalek[EV==2024]-ellenzek_szazalek[EV==2024]),
fidesz_ellenz_kulonb_csokkent=(fidesz_szazalek[EV==2019]-ellenzek_szazalek[EV==2019]) >
(fidesz_szazalek[EV==2024]-ellenzek_szazalek[EV==2024]),
fidesz_absz_tobb_2019=fidesz_szazalek[EV==2019]>=50,
fidesz_absz_tobb_2024=fidesz_szazalek[EV==2024]>=50,
fidesz_gyoz_2019=fidesz_szazalek[EV==2019]>ellenzek_szazalek[EV==2019],
fidesz_gyoz_2024=fidesz_szazalek[EV==2024]>ellenzek_szazalek[EV==2024]) %>%
pivot_longer(!c(TELEPÜLÉS,telep_meret)) %>%
group_by(name,telep_meret) %>%
summarise(n_telep_krit=sum(value),n_telep_ossz=n()) %>%
mutate(EV=ifelse(grepl("2019",name),2019,ifelse(grepl("2024",name),2024,NA)),
name=gsub("_2019|_2024","",name), # ↑↓
plot_name=case_when(# grepl("szaz_nott",name) ~ "FIDESZ % ↑",
grepl("szaz_csokk",name) ~ "FIDESZ % ↓",
grepl("gyoz",name) ~ "FIDESZ>ellenzék",
# grepl("kulonb_nott",name) ~ "FIDESZ − ellenzék ↑",
grepl("kulonb_csokk",name) ~ "FIDESZ − ellenzék ↓",
grepl("absz",name) ~ "FIDESZ>50%" ) ) %>%
mutate(telep_meret_szam=factor(paste0(telep_meret," (n=",n_telep_ossz,")")),
telep_meret_szam=reorder(telep_meret_szam,as.numeric(telep_meret)))
# PLOT
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit)) +
geom_text(data = l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.92*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit)) + # hjust=2,
xlab("telepulesek szama") + ylab("") + theme_bw() + val_theme
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=40,height=30,units="cm")
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=30,height=25,units="cm")
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=4) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.95*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit)) + # hjust=2,
xlab("települések száma") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.9*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.95*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
# SAVE
if (T) {
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=30,height=25,units="cm")
}
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
# SAVE
if (T) {
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=30,height=25,units="cm")
}
l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0))
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=30,height=25,units="cm")
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
geom_vline(aes(xintercept=n_telep_ossz) ) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
geom_vline(aes(xintercept=n_telep_ossz) ) +
geom_vline(aes(xintercept/2=n_telep_ossz),linewidth=1/2) +
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
geom_vline(aes(xintercept=n_telep_ossz) ) +
geom_vline(aes(xintercept=n_telep_ossz/2),linewidth=1/2) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
geom_vline(aes(xintercept=n_telep_ossz) ) +
geom_vline(aes(xintercept=n_telep_ossz/2),linewidth=1/4) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
# SAVE
if (T) {
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=30,height=25,units="cm")
}
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
geom_vline(aes(xintercept=n_telep_ossz) ) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
# SAVE
if (T) {
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=30,height=25,units="cm")
}
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=32,height=25,units="cm")
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=33,height=25,units="cm")
# PLOT
l_fidesz_krit_telepszam %>%
ggplot(aes(y=plot_name)) + facet_wrap(~telep_meret_szam,scales="free_x") +
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_krit),size=4,alpha=2/3) + # ,color=factor(EV)
geom_segment(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV)) %>%
select(!c(name,telep_meret,n_telep_ossz)) %>%
pivot_wider(names_from=EV,values_from=n_telep_krit),
aes(x=`2019`,xend=`2024`),size=1.1,arrow=arrow(length=unit(0.3,"cm"))) +
# margins
geom_point(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)),
aes(x=n_telep_ossz),color=NA) + # ,color=factor(EV)
geom_point(data=l_fidesz_krit_telepszam %>% group_by(telep_meret_szam) %>%
summarise(n_telep_krit=min(c(0.87*min(n_telep_krit),min(n_telep_krit)-1))),
aes(x=n_telep_krit,y=1),color=NA) + # ,color=factor(EV)
# labels
geom_text(data = l_fidesz_krit_telepszam %>% filter(!is.na(EV) & !(EV==2019 & n_telep_krit==0)),
aes(x=n_telep_krit,hjust=ifelse(EV==2019,-0.1,1.2),label=n_telep_krit),size=5) +
geom_text(data=l_fidesz_krit_telepszam %>% filter(is.na(EV)) %>%
group_by(telep_meret_szam,plot_name) %>%
summarise(x_pos=min(c(0.93*n_telep_krit,n_telep_krit-1/2)),
n_telep_krit=unique(n_telep_krit)),
aes(x=x_pos,label=n_telep_krit),size=5) +
geom_vline(aes(xintercept=n_telep_ossz) ) +
labs(caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+")) ) +
xlab("települések száma") + ylab("") + theme_bw() + val_theme
"PLOTS/fidesz_ellenzek_aggreg_nvalpolg_kateg_krit_ntelep.png" %>%
ggsave(width=33,height=25,units="cm")
