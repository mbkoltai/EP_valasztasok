filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept = 0)) +
scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=18),
plot.caption=element_text(size=12),plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept = 0)) +
scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=18),
legend.text=element_text(size=16),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept = 0)) +
scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=18),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept = 0)) +
scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=18),
legend.text=element_text(size=12),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
"PLOTS/fidesz_ellenzek_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>%
ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept = 0)) +
scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
if (T) {
"PLOTS/fidesz_ellenzek_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>%
ggsave(width=40,height=30,units="cm")
}
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
# filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
# scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
# filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
scale_color_manual(values = c("#619CFF","darkorange","black","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
"PLOTS/fidesz_ellenzek_mihaz_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>% ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
# filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/(ifelse(grepl("szav",tipus),4,3)+1),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
scale_color_manual(values = c("#619CFF","darkorange","black","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2014→2019 változás",fill="2014 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
"PLOTS/fidesz_ellenzek_mihaz_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>% ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/ifelse(grepl("szav",tipus),4,3),
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus)) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=value_2019,xend=value_2024),size=1.6,
arrow=arrow(length=unit(0.45,"cm"))) +
geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept = ifelse(grepl("szav",tipus),NA,50))) +
scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) +
scale_fill_manual(values = c("#619CFF","darkorange","darkgrey")) +
scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2019→2024 változás",fill="2019 eredmény",
caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(plot.caption=element_text(size=12),
plot.caption.position="plot")
"PLOTS/fidesz_ellenzek_2019_2024_aggreg_nvalpolg_kateg.png" %>%
ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/(ifelse(grepl("szav",tipus),4,3)), # +1
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
scale_color_manual(values = c("#619CFF","darkorange","black","darkgrey")) +
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2019→2024 változás",fill="2019 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
"PLOTS/fidesz_ellenzek_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>%
ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/(ifelse(grepl("szav",tipus),4,3)), # +1
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
scale_color_manual(values = c("#619CFF","darkorange","darkgrey")) + # ,"black"
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2019→2024 változás",fill="2019 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
"PLOTS/fidesz_ellenzek_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>%
ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
# filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/(ifelse(grepl("szav",tipus),4,3)), # +1
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
scale_color_manual(values = c("#619CFF","darkorange","black","darkgrey")) + #
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2019→2024 változás",fill="2019 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
"PLOTS/fidesz_ellenzek_mihazank_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>%
ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
# filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/(ifelse(grepl("szav",tipus),4,3) +1), #
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
scale_color_manual(values = c("#619CFF","darkorange","black","darkgrey")) + #
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2019→2024 változás",fill="2019 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
"PLOTS/fidesz_ellenzek_mihazank_2019_2024_valtozas_aggreg_nvalpolg_kateg.png" %>%
ggsave(width=40,height=30,units="cm")
ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
# filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/(ifelse(grepl("szav",tipus),4,3) +
ifelse(grepl("Mi H",lista_osszes),1,0)), #
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019) %>%
ggplot(aes(y=y_pos,group=lista_osszes,color=lista_osszes)) +
facet_wrap(~tipus,scales="free_x",nrow=2) +
geom_segment(aes(x=0,xend=valtozas),size=2,arrow=arrow(length=unit(0.4,"cm"))) +
# geom_point(aes(x=value_2019,fill=lista_osszes),size=2.5,shape=21,color="black") +
geom_hline(yintercept=(1:7),linetype="dashed",linewidth=2/3) +
geom_vline(aes(xintercept=0)) +
scale_color_manual(values = c("#619CFF","darkorange","black","darkgrey")) + #
# scale_x_continuous(breaks=c(seq.default(30,65,by=10),35,45,seq.default(2,12,by=2)*100)) +
scale_y_continuous(breaks=1/2+(0:7),
labels=with(ep_2019_2024_nvalpolg_fidesz_ellenzek,levels(telep_meret))) +
labs(color="2019→2024 változás",fill="2019 eredmény", caption=paste0("ellenzék 2019=",
paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2019]),collapse="+"),"\n",
"ellenzék 2024=",paste0(with(ellenzek_listak_2019_2024,LISTA[EV==2024]),collapse="+"))) +
xlab("") + ylab("választópolgárok száma") +
theme_bw() + val_theme + theme(legend.title=element_text(size=20),
legend.text=element_text(size=14),
plot.caption=element_text(size=12),
plot.caption.position="plot",legend.position="top") +
guides(color=guide_legend(title.position="top",label.position="bottom"))
df_plot_valtozas <- ep_2019_2024_nvalpolg_fidesz_ellenzek %>%
# filter(!grepl("Mi H",lista_osszes)) %>%
group_by(telep_meret,EV,lista_osszes) %>%
summarise(n_szavazat=sum(n_szavazat)) %>%
mutate(százalék=100*n_szavazat/n_szavazat[lista_osszes %in% "összes"]) %>%
pivot_longer(c(n_szavazat,százalék),names_to="tipus") %>%
filter(!(lista_osszes %in% "összes" & value==100)) %>%
pivot_wider(names_from="EV",names_prefix="value_") %>%
mutate(y_base=as.numeric(telep_meret)-1,
y_adj=as.numeric(factor(lista_osszes))*1/(ifelse(grepl("szav",tipus),4,3) +
ifelse(grepl("Mi H",lista_osszes),1,0)), #
y_pos=y_base+y_adj,
value_2019=value_2019/ifelse(grepl("szav",tipus),1e3,1),
value_2024=value_2024/ifelse(grepl("szav",tipus),1e3,1),
tipus=ifelse(grepl("szav",tipus),"szavazatok száma (ezer)",tipus),
valtozas=value_2024-value_2019)
grepl("Mi Haz",df_plot_valtozas$lista_osszes)
any(grepl("Mi Haz",df_plot_valtozas$lista_osszes))
paste0("PLOTS/fidesz_ellenzek_",ifelse(any(grepl("Mi Haz",df_plot_valtozas$lista_osszes)),"mihazank",""),
"2019_2024_valtozas_aggreg_nvalpolg_kateg.png")
getwd()
